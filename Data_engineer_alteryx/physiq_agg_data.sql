
WITH my_tables_data AS ( select Min([idx]) as idx1 ,[patient_id] as patient_id1 from [master].[dbo].[newfullload_physiq] where [heart-rate] is not null and [respiration-rate] is not null group by [patient_id] ) SELECT [patient_id], [idx], [agg-piq-torso-24hr-30-minute-most-active-per-1hr_confidence] ,[agg-piq-torso-24hr-MVPA-Swartz-per-1hr_confidence] ,[agg-piq-torso-24hr-hours-asleep-per-1hr_confidence] ,[agg-piq-torso-24hr-resting-asleep-heart-rate-per-1hr_confidence] ,[agg-piq-torso-24hr-resting-asleep-respiration-rate-per-1hr_confidence] ,[agg-piq-torso-24hr-resting-awake-heart-rate-per-1hr_confidence] ,[agg-piq-torso-24hr-resting-awake-respiration-rate-per-1hr_confidence] ,[agg-piq-torso-24hr-step-count-per-1hr_confidence] ,[avg-afib-prob] ,[avg-afib-prob_confidence] ,[avg-sleep-prob] ,[avg-sleep-prob_confidence] ,[avg-walk-probability] ,[avg-walk-probability_confidence] ,[count-of-magnitude] ,[count-of-magnitude_confidence] ,[ecg-sqi] ,[ecg-sqi_confidence] ,[gross-activity] ,[gross-activity_confidence] ,[heart-rate] ,[heart-rate_confidence] ,[hrv-td] ,[hrv-td_confidence] ,[magnitude-of-uni-counts] ,[magnitude-of-uni-counts_confidence] ,[max-of-uni-counts] ,[max-of-uni-counts_confidence] ,[percent-afib] ,[percent-afib_confidence] ,[percent-asleep] ,[percent-asleep_confidence] ,[posture] ,[posture_confidence] ,[respiration-rate] ,[respiration-rate_confidence] ,[step-count] ,[step-count_confidence] ,[tilt] ,[tilt_confidence] ,[trailing-activity] ,[trailing-activity_confidence] ,[uni-count-x] ,[uni-count-x_confidence] ,[uni-count-y] ,[uni-count-y_confidence] ,[uni-count-z] ,[uni-count-z_confidence] ,[walk-percent] ,[walk-percent_confidence] FROM [master].[dbo].[newfullload_physiq] b join my_tables_data on my_tables_data.idx1=b.idx and my_tables_data.patient_id1=b.patient_id ;